# Rétrospective Epic 2 — Le Mode Expert

**Date :** 2026-02-11  
**Epic :** Epic 2 — Le Mode Expert (Personnalisation Avancée & Immersion)  
**Facilitateur :** Bob (Scrum Master)  
**Participants :** Julien (Project Lead), équipe Dev, Quinn (QA)

---

## 1. Résumé de l’Epic

### Livraison

| Métrique | Valeur |
|----------|--------|
| Stories livrées | 3/3 (2.1, 2.2, 2.3) |
| Critères d’acceptation | Couverts (FR2, FR3, FR8) |
| Tests exécutés (QA) | 14 (13 E2E + 1 API) — tous passants |
| Correctifs pendant la QA | 2 (locators Playwright) |

### Qualité

- **Code review :** 8 points sur Story 2.1 (dont 2 critiques) — tous corrigés. Stories 2.2 et 2.3 : revues Senior Dev avec correctifs appliqués.
- **Dette technique identifiée :** Vue warn sur Tooltip (attributs non-props) à traiter en amont ; retry réseau partiellement documenté (3x backoff implémenté en 2.3).
- **Incidents production :** 0.

### Résultats métier

- Toggle Mode Expert opérationnel avec persistance des sélections (FR2, FR3).
- Sidebar technique HUD avec mods CPU / Audio / Alimentation et Configuration de Base.
- Mises à jour optimistes + rollback + effet Glitch en cas d’erreur (FR8).

---

## 2. Ce qui a bien fonctionné

- **Story 2.1 comme fondation :** État `isExpertMode`, toggle, structure de base d’ExpertSidebar et préservation des sélections ont donné une base claire pour 2.2 et 2.3.
- **Code review systématique :** Détection rapide de conflits de layout (SelectionRecap / ExpertSidebar), z-index, responsive et accessibilité (ARIA, clavier). Tous les points ont été corrigés avant merge.
- **Séparation backend / frontend :** Modèle `ExpertMod`, `GET /catalog/expert-mods`, règles dans `logic/rules.rs` et calcul dans `calculator.rs` — bonne séparation des responsabilités.
- **QA Quinn :** 14 tests (E2E + API) avec rapport clair ; 2 correctifs de locators pendant la QA pour des tests plus robustes.
- **Pattern optimistic update :** Rollback, queue de validation et GlitchEffect bien intégrés ; retry 3x avec backoff ajouté après review.

---

## 3. Défis et axes d’amélioration

- **Alignement sprint-status / réalité :** Dans `sprint-status.yaml`, la story 2-2 est encore en `ready-for-dev` alors que le fichier de story et la QA la considèrent livrée. À aligner pour éviter toute ambiguïté sur la complétion de l’Epic.
- **Locators E2E fragiles :** Deux corrections pendant la QA (ciblage de la sidebar, texte « Budget Gamer » en strict mode). Renforcer les sélecteurs (data-testid ou rôles ARIA) pour limiter la fragilité des tests.
- **Backend requis pour les tests API :** Les tests `api-integration.spec.js` (ex. GET /catalog/expert-mods) supposent le backend sur le port 3000. Pour la CI : soit lancer le backend avant les tests, soit marquer ces tests comme conditionnels.
- **Warning Vue (Tooltip) :** Attributs non-props (id, role) sur le composant Tooltip — à corriger pour des logs plus propres et une meilleure maintenabilité.

---

## 4. Leçons apprises

1. **Infrastructure d’abord (2.1) puis contenu (2.2) puis logique avancée (2.3)** — L’ordre des stories a limité les rework et les conflits de layout.
2. **Code review tôt = moins de dette** — Les points de layout, z-index et accessibilité corrigés en 2.1 ont évité des régressions dans 2.2/2.3.
3. **Tests E2E sur la sidebar** — Les locators basés uniquement sur le texte ou la structure DOM ont montré leurs limites ; privilégier des attributs stables (data-testid, ARIA) pour les prochaines features.
4. **Rapport QA comme entrée de rétro** — Le rapport de Quinn a permis de valider la couverture (AC, FR) et d’identifier les correctifs à capitaliser (sélecteurs, CI).

---

## 5. Suivi de la rétrospective précédente

Aucune rétrospective Epic 1 trouvée dans les artifacts. Pas d’action items antérieurs à suivre.

---

## 6. Aperçu Epic 3 et préparation

**Epic 3 :** « Le Gestionnaire de Deck » — Persistance & Multi-Console (FR4, FR5, FR6).

### Dépendances sur Epic 2

- Mode Expert et devis avec `expert_options` sont stables ; pas de changement prévu pour le Deck.
- Store Pinia (`configurator`) et `POST /quote` avec `expert_options` peuvent servir de référence pour les futurs payloads (ex. deck avec plusieurs configs).

### Préparation recommandée avant / en début d’Epic 3

- **Technique :** Vérifier que les migrations 007/008 (expert_mods) et le schéma Deck (si déjà prévus) sont appliqués et documentés.
- **CI :** Décider comment exécuter les tests API (backend sur 3000 ou tests conditionnels) et le documenter (README ou playwright.config).
- **Qualité :** Introduire des `data-testid` (ou équivalent) sur les composants clés (toggle Expert, sidebar, cartes mods) pour renforcer la stabilité des tests E2E.

---

## 7. Action items

| # | Action | Responsable | Critère de succès |
|---|--------|-------------|--------------------|
| 1 | Aligner `sprint-status.yaml` : 2-2 → done, epic-2 → done si tout est livré | Équipe / SM | Fichier cohérent avec l’état réel des stories |
| 2 | Corriger le warning Vue sur le composant Tooltip (attributs non-props) | Dev | Plus de warning dans la console sur ce composant |
| 3 | Documenter l’exécution des tests API (backend requis ou tests conditionnels) dans CI / README | Dev / QA | Procédure claire pour lancer les tests Epic 2 (et futurs) |
| 4 | Ajouter des attributs stables (data-testid ou ARIA) sur ExpertSidebar / ExpertModCard pour les tests E2E | Dev | Réduction des correctifs de locators en QA |

---

## 8. Tâches de préparation Epic 3

- [ ] Vérifier les migrations et le schéma DB pour le Deck (auth, deck).
- [ ] Définir la stratégie CI pour les tests Playwright (backend, ports, tests conditionnels).
- [ ] Planifier la première story Epic 3 (ex. 3.0 Auth ou 3.1 UI Deck) une fois la préparation validée.

---

## 9. État de préparation

| Dimension | État | Commentaire |
|----------|------|-------------|
| Tests & qualité | OK | 14 tests verts, correctifs QA appliqués |
| Déploiement | Non traité | À préciser selon votre processus |
| Acceptation métier | À valider | À confirmer avec le Product Owner / parties prenantes |
| Santé technique | Bonne | Dette limitée (Tooltip, CI à documenter) |
| Bloqueurs connus | Aucun | — |

---

## 10. Clôture

L’Epic 2 « Le Mode Expert » est considérée comme livrée : 3 stories implémentées, revues et couvertes par la QA. La rétrospective a mis en avant la solidité de l’ordre des stories, l’apport du code review et du rapport QA, et quelques actions concrètes (sprint-status, Tooltip, CI, locators) pour les prochaines epics.

**Prochaines étapes :** Exécuter les action items ci-dessus, finaliser la préparation Epic 3, puis démarrer la création des stories Epic 3 (SM — create-story) lorsque l’équipe est prête.

---

*Généré par : Bob (Scrum Master) — Workflow : Epic Retrospective [ER]*  
*Document : epic-2-retro-2026-02-11.md*
