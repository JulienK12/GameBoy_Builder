# Rétrospective Epic 1 — L'Atelier de Base (Starter Kits & Moteur de Prix)

**Date :** 2026-02-13  
**Epic :** 1 — L'Atelier de Base  
**Stories :** 3/3 done (1.1 Portail dynamique, 1.2 Bundle backend & tarification, 1.3 HUD Airy & Récapitulatif)

---

## 1. Contexte et périmètre

- **FR couverts :** FR1 (Starter Kits), FR7 (Validation backend prix/compat), FR9 (Double-portail HUD).
- **Première rétrospective** du projet : pas de rétro précédente à suivre.
- **Épic suivante :** Epic 2 — Le Mode Expert (personnalisation avancée, toggle Expert, sidebar technique, optimistic updates).

---

## 2. Analyse des stories (synthèse)

### 2.1 Story 1.1 — Système de Portail Dynamique

- **Livrables :** Table `packs`, endpoint `GET /catalog/packs`, seed 3 packs (Budget, Performance, Purist), composant `LandingPortal.vue`, intégration store Pinia (`fetchPacks`, `selectPack`, `showLandingPortal`).
- **Points forts :** Respect strict de l’architecture 3-tier (api → logic → data), Pack = référence pure (pas de prix en dur), pattern aligné avec les handlers existants.
- **Revue / corrections :** Code review avec correctifs (données seed, nettoyage). Tests Playwright (`landing-portal.spec.js`).

### 2.2 Story 1.2 — Logique de Bundle Backend & Tarification

- **Livrables :** Extension `QuoteRequest` (pack_id, overrides), `resolve_pack()` dans `catalog.rs`, `ResolvedComponents` / `PackOverrides`, adaptation du handler `POST /quote` sans changer la signature de `calculate_quote()`.
- **Points forts :** Zéro régression sur le moteur de prix (8 tests unitaires préservés), résolution pack faite en amont du calcul.
- **Notes dev :** Imports et emplacement de `resolve_pack` corrigés (catalog vs calculator) pour respecter l’architecture.

### 2.3 Story 1.3 — Mise en page HUD Airy & Récapitulatif

- **Livrables :** Refactoring `SelectionRecap.vue` (gap-8, p-8, glass-premium, font-retro), badge Pack, `<TransitionGroup>`, synchro prix temps réel, tests Playwright (`selection-recap.spec.js`).
- **Points forts :** Design system "Airy Cyberpunk" appliqué de façon cohérente, accessibilité (ARIA) renforcée.

### 2.4 Patterns transversaux

- **Architecture :** Séparation claire backend (Rust 3-tier) / frontend (Vue 3, Pinia), pas de logique métier dans les handlers.
- **Qualité :** Tests unitaires (Rust) et E2E (Playwright) présents ; code review systématique avec corrections.
- **Documentation :** Stories avec Dev Notes détaillées, contraintes architecturales et références (api-contracts, ux-design-spec).

---

## 3. Rapport QA (intégration — source : test-summary-epic-1.md, Quinn 2026-02-13)

**Source :** Rapport QA Epic 1 — `tests/test-summary-epic-1.md` (Quinn, 2026-02-13). Synthèse ci-dessous alignée sur ce rapport.

### 3.1 Résumé exécutif

| Périmètre | Résultat | Détail |
|-----------|----------|--------|
| Backend Rust (Story 1.2) | ✅ 22/22 tests passés | Moteur de prix + résolution pack (12 tests ignorés — auth/deck/quote_submit nécessitent PostgreSQL) |
| E2E selection-recap (Story 1.3) | ✅ 3/3 passés | Badge Pack, mise à jour Recap, gap-8 (getComputedStyle) — API mockée, pas de backend requis |
| E2E landing-portal (Story 1.1) | ⚠️ 1/4 passé | AC #1 OK ; #2–#5 nécessitent backend + PostgreSQL (`cargo run` puis Playwright) |

**Statut QA Epic 1 :** ✅ Validé pour le périmètre testable sans backend. Validation complète landing-portal : lancer le backend puis `npx playwright test landing-portal.spec.js`.

### 3.2 Couverture par critères d'acceptation (rapport Quinn)

| Story | AC | Statut |
|-------|-----|--------|
| 1.1 | #1 (Landing Portal, 2 cartes) | ✅ |
| 1.1 | #2–#5 (packs API, sélection pack, Atelier Libre, prix backend) | ⚠️ Backend requis |
| 1.2 | #1 à #5 (pack_id, overrides, invalide, régression, composant manquant) | ✅ |
| 1.3 | #1 à #5 (Airy, image/nom/prix, rafraîchissement, badge Pack, prix temps réel) | ✅ |

### 3.3 Problèmes et recommandations (rapport Quinn)

1. **landing-portal.spec.js et backend :** Les scénarios qui cliquent sur "Starter Kits" et chargent les packs nécessitent le backend sur `http://localhost:3000`. Documenter la procédure (Terminal 1 : `cargo run` ; Terminal 2 : `npx playwright test landing-portal.spec.js`) ou prévoir un mock des appels API dans le spec pour exécution sans backend.
2. **Option mock :** Comme pour selection-recap, mocker `GET /catalog/packs` dans landing-portal.spec.js permettrait de valider la logique UI sans backend, au prix de ne pas valider l'intégration réelle.

### 3.4 Synthèse rétro

- **Points forts :** Story 1.2 et 1.3 entièrement couvertes et vertes ; zéro régression moteur de prix ; architecture validée (resolve_pack dans `data/`, calculate_quote inchangé dans `logic/`).
- **À capitaliser :** Clarifier la stratégie E2E (backend requis vs mock) pour les specs qui appellent l'API, et l'indiquer en prérequis dans les stories ou le README.

---

## 4. Suivi de la rétrospective précédente

Aucune rétrospective Epic 0. Pas d’action items antérieurs à suivre.

---

## 5. Aperçu Epic 2 et dépendances

- **Epic 2 :** Le Mode Expert — Toggle Expert, Sidebar technique HUD, optimistic updates avec rollback.
- **Dépendances sur Epic 1 :** Store configurator (packs, sélections), `POST /quote` (pack_id + overrides), Selection Recap et design system déjà en place. Base solide pour ajouter le mode Expert et la personnalisation fine.
- **Prérequis techniques :** Aucun blocage identifié ; le moteur de prix et le portail sont stables.

---

## 6. Ce qui a bien fonctionné

- **Ordre des stories :** 1.1 → 1.2 → 1.3 a permis de poser d’abord les données (packs, portail), puis la tarification, puis l’UX récap.
- **Contraintes explicites :** "Zéro régression", "signature de `calculate_quote()` inchangée", "Pack = référence pure" ont guidé les choix techniques.
- **Artifacts :** Dev Notes et tâches détaillées dans les stories ont facilité l’implémentation et la revue.
- **Tests :** Couverture backend (unit + intégration) et frontend (Playwright) alignée avec les AC.

---

## 7. Défis et axes d’amélioration

- **Story 1.2 :** Ajustements post-review (imports, emplacement de `resolve_pack`) — renforcer la vérification de l’architecture (data vs logic) dès la revue.
- **Pas de section "Lessons Learned" ou "Technical Debt" explicite** dans les stories ; utile d’ajouter un bloc court en fin de story (ou en revue) pour capitaliser.
- **Estimation :** Pas de suivi formalisé de vélocité (points/sprint) ; optionnel pour les prochaines epics si besoin de prédictibilité.

---

## 8. Action items proposés

| # | Action | Responsable | Critère de succès |
|---|--------|-------------|-------------------|
| 1 | Conserver le format Dev Notes + contraintes architecturales dans les prochaines stories | SM (Bob) | Chaque story créée inclut une section contraintes/patterns |
| 2 | En revue, vérifier systématiquement que la logique "data" reste dans `data/` et "moteur" dans `logic/` | Dev / Review | Aucune logique de résolution métier dans `api/` ou `logic/` quand elle relève du catalogue |
| 3 | Optionnel : ajouter en fin de story un court "Lessons Learned" ou "Technical Debt" après implémentation | Dev | Au moins une ligne dans les stories à forte décision technique |
| 4 | Documenter la procédure E2E landing-portal (backend requis) ou mocker GET /catalog/packs dans le spec (reco. rapport QA Epic 1) | Dev / QA | README ou commentaire dans le spec ; ou tests passent sans backend |

---

## 9. Préparation Epic 2

- **État :** Aucune préparation bloquante identifiée. Les briques Epic 1 (catalogue, packs, quote, recap) sont en place.
- **Recommandation :** Démarrer Epic 2 sans tâche de préparation critique ; continuer à s’appuyer sur les mêmes patterns (store Pinia, backend Rust, design system Airy Cyberpunk).

---

## 10. Synthèse et clôture

- **Epic 1** est considérée comme **livrée** : 3 stories done, revues et couvertes par les tests.
- **Points clés :** architecture respectée, zéro régression sur le moteur de prix, design system et portail bien posés pour la suite.
- **Prochaine étape :** Epic 2 — Le Mode Expert ; rétro Epic 2 déjà réalisée (epic-2-retro-2026-02-11.md), les engagements de cette rétro Epic 1 viennent en renfort pour les epics suivantes.

---

*Généré par : Bob (Scrum Master) — Workflow : Epic Retrospective [ER]*  
*Document : epic-1-retro-2026-02-13.md*
